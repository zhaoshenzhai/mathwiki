{{- $path := .Get "file" -}}
{{- $display := .Get "display" -}}
{{- $id := .Get "id" -}}

{{- $link := absURL $path -}}
{{- $page := .Page.GetPage $path -}}
{{- $mathLink := $page.Params.mathLink -}}

{{- $name := "" -}}
{{- if $display -}}
    {{ $name = $display -}}
{{- else -}}
    {{ if $mathLink -}}
        {{ $name = $mathLink -}}
    {{ else -}}
        {{ $name = $page.Title -}}
    {{ end -}}
{{- end -}}

{{- $title := "" -}}
{{- $mod := "" -}}
{{- if $page -}}
    {{ $title = $page.Title -}}
{{- else -}}
    {{ $title = $display -}}
    {{ $mod = "ghostLink" -}}
{{- end -}}

{{- if $id -}}
    {{ $link = printf "%s%s%s" $link "/#" $id -}}
{{- end -}}

<a href={{ $link }} class="internalLink {{ $mod }}" id="{{ $id }}" title="{{ $title }}" mathLink="{{ $mathLink }}" onclick="onLinkClick(event, {{ $link }}, {{ $page }});">{{ $name }}</a>{{- "" -}}
